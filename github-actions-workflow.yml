name: Daily AI Travel Shorts Generator

# ë§¤ì¼ ì˜¤ì „ 9ì‹œ (í•œêµ­ ì‹œê°„ ê¸°ì¤€ ì˜¤ì „ 9ì‹œ = UTC 0ì‹œ)
on:
  schedule:
    - cron: '0 0 * * *'  # ë§¤ì¼ UTC 0ì‹œ = í•œêµ­ ì˜¤ì „ 9ì‹œ
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ë„ ê°€ëŠ¥

jobs:
  generate-shorts:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¦ ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v3
    
    - name: ğŸ Python ì„¤ì •
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: ğŸ“š ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        pip install -r requirements.txt
    
    - name: ğŸ¬ FFmpeg ì„¤ì¹˜
      run: |
        sudo apt-get update
        sudo apt-get install -y ffmpeg
    
    - name: ğŸŒ ëœë¤ ì—¬í–‰ì§€ ì„ íƒ ë° ë©”íƒ€ë°ì´í„° ìƒì„±
      run: |
        python3 scripts/auto_generate_shorts.py
    
    - name: ğŸ“¤ ë©”íƒ€ë°ì´í„° ì—…ë¡œë“œ (Artifact)
      uses: actions/upload-artifact@v3
      with:
        name: travel-metadata
        path: output/*_metadata.json
    
    - name: ğŸ“§ ì´ë©”ì¼ ì•Œë¦¼ ì „ì†¡
      if: success()
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 587
        username: ${{ secrets.SMTP_USERNAME }}
        password: ${{ secrets.SMTP_PASSWORD }}
        subject: "ğŸŒ AI ì—¬í–‰ ì‡¼ì¸  ìƒì„± ì™„ë£Œ"
        to: cogurrl@gmail.com
        from: AI Travel Shorts Bot
        body: |
          ìƒˆë¡œìš´ ì—¬í–‰ ì‡¼ì¸ ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!
          
          GitHub Actionsì—ì„œ ë©”íƒ€ë°ì´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”:
          ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}
        
    - name: âŒ ì‹¤íŒ¨ ì‹œ ì•Œë¦¼
      if: failure()
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 587
        username: ${{ secrets.SMTP_USERNAME }}
        password: ${{ secrets.SMTP_PASSWORD }}
        subject: "âŒ AI ì—¬í–‰ ì‡¼ì¸  ìƒì„± ì‹¤íŒ¨"
        to: cogurrl@gmail.com
        from: AI Travel Shorts Bot
        body: |
          ì˜ìƒ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
          
          ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”:
          ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}

# ì°¸ê³ : AI ì˜ìƒ/ìŒì•… ìƒì„±ì€ ì™¸ë¶€ API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤
# GitHub Secretsì— ë‹¤ìŒì„ ì„¤ì •í•˜ì„¸ìš”:
# - SMTP_USERNAME: Gmail ì´ë©”ì¼
# - SMTP_PASSWORD: Gmail ì•± ë¹„ë°€ë²ˆí˜¸
# - AI_API_KEY: AI ì˜ìƒ ìƒì„± API í‚¤ (RunwayML, Pika Labs ë“±)
